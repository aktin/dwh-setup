TRUNCATE TABLE PM_HIVE_DATA;
Insert into PM_HIVE_DATA (DOMAIN_ID,HELPURL,DOMAIN_NAME,ENVIRONMENT_CD,ACTIVE,STATUS_CD) 
	VALUES('@DBNAME@','http://www.i2b2.org','@I2B2HIVEID@','DEVELOPMENT',1,'A');

-- user roles
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'OBFSC_SERVICE_ACCOUNT', 'USER', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='OBFSC_SERVICE_ACCOUNT' AND USER_ROLE_CD='USER');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'OBFSC_SERVICE_ACCOUNT', 'DATA_OBFSC', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='OBFSC_SERVICE_ACCOUNT' AND USER_ROLE_CD='DATA_OBFSC');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'AGG_SERVICE_ACCOUNT', 'USER', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='AGG_SERVICE_ACCOUNT' AND USER_ROLE_CD='USER');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'AGG_SERVICE_ACCOUNT', 'DATA_AGG', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='AGG_SERVICE_ACCOUNT' AND USER_ROLE_CD='DATA_AGG');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'AGG_SERVICE_ACCOUNT', 'DATA_OBFSC', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='AGG_SERVICE_ACCOUNT' AND USER_ROLE_CD='DATA_OBFSC');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'i2b2', 'MANAGER', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='i2b2' AND USER_ROLE_CD='MANAGER');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'i2b2', 'USER', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='i2b2' AND USER_ROLE_CD='USER');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', 'i2b2', 'DATA_OBFSC', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='i2b2' AND USER_ROLE_CD='DATA_OBFSC');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'USER', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='USER');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'DATA_DEID', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='DATA_DEID');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'DATA_OBFSC', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='DATA_OBFSC');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'DATA_AGG', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='DATA_AGG');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'DATA_LDS', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='DATA_LDS');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'EDITOR', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='EDITOR');
INSERT INTO PM_PROJECT_USER_ROLES (PROJECT_ID, USER_ID, USER_ROLE_CD, STATUS_CD)
	SELECT '@I2B2PROJECTNAME@', '@I2B2PROJECT@', 'DATA_PROT', 'A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_USER_ROLES WHERE PROJECT_ID='@I2B2PROJECTNAME@' AND USER_ID='@I2B2PROJECT@' AND USER_ROLE_CD='DATA_PROT');

-- project data
Insert into PM_PROJECT_DATA (PROJECT_ID,PROJECT_NAME,PROJECT_WIKI,PROJECT_PATH,STATUS_CD) 
	SELECT '@I2B2PROJECTNAME@','i2b2 @I2B2PROJECT@','http://www.i2b2.org','/@I2B2PROJECTNAME@','A'
	WHERE
		NOT EXISTS (SELECT 1 FROM PM_PROJECT_DATA WHERE PROJECT_ID='@I2B2PROJECTNAME@');
